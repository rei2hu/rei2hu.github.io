# ai generated code in prod

Recently, there was a bug where data was being labeled with a "cannot fetch
information" message at the place where I work at. No one was sure if this was
an issue on our end or another company's end because we were fetching
information from an external api and tacking that information on.

It was assigned to one person previously, who found out that the message came
from our code and said it's because the external api may not return some
specific pieces of information under certain cases (e.g. nullable or optional
fields) so that message pops up, but did no further investigation.

I ended up picking this task up and continued the work by pulling credentials
from the database, manually making calls to the external api, and looking at the
response - alright, the fields don't exist (as expected because that's why the
code followed that specific path).

I then looked up the official documentation for the external api that describes
the possible fields in the response for the specific endpoint we're working with
and found out that the fields our code was looking for were not mentioned in the
documentation but were instead nested elsewhere in the response. Perhaps they
made a kind of breaking change and (re)moved the fields we were previously
looking at?

The official documentation actually included a relatively comprehensive section
about versioning and supposed guarantees about keeping backwards compatibility
which included the mention of not removing any fields unless there was a major
version change; their versioning followed semver (semantic versioning) and was
still on 0.x.y, so it seemed impossible that the major version could have ever
changed.

Finally, I looked at the blame for the classes in our code that described the
response objects, and found the original pull request that introduced them. One
year ago, the dev that made those classes left a comment on how the classes were
generated by copilot by feeding the official documentation into it and was a
great time-save. Right, it saved time and generated inaccurate code. To be
honest, the classes are like 400 lines of simple property only classes so it
would've been "boring" to write. And it actually also had the correct fields
too; it's just that the code ended up looking at the incorrect ones. e.g.

```js
{
    // foo, bar are the real fields
    foo: 1,
    bar: 1,
    vars: {
        // foo, bar are made up
        foo: 1,
        bar: 1,
        baz: 1,
    },
    // a ton more properties...
}
```

Once I made the fix, the original author messaged me privately about the
generated classes AND the original part of the code; what we discussed really
made me think that they had minimal handle on what they actually wrote, and that
the classes weren't the only thing AI generated (the other code was good,
though).

Anyways, coming across something like that is what really makes me lose faith in
professional software engineers. Why?

1. AI was used and the output was not checked thoroughly. AI was used for a
   simple case, got things wrong, and it wasn't caught by the original dev nor
   the two reviewers (though, as a reviewer but not one of the two reviewers on
   the introductory pull request, I would not have verified the entire classes
   in depth with the official documentation because that's basically doing the
   actual work...) And, to be frank, the made up fields were in a plausible
   place in the response.

2. Code that never worked was deployed to prod. Sometimes it's hard to check if
   a feature works before deploying to prod, but this was not one of those
   times; there was enough test data in the development environment, and the
   company that provided the api also provided a sandbox environment to aid with
   testing things on their side.

In general, I think the bar for technical skill/craftsmanship is a lot lower in
the professional world (after the interview, of course). Obviously everyone has
different bars so opinions may vary, but mine definitely include making sure the
code you write (or generate with AI) works.

Though I haven't used AI generated code in either professional or hobby
development yet.
