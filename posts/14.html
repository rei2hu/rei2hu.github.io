
<!DOCTYPE html>
<html>
<head>
<meta charset=UTF-8>
<meta content="width=device-width,initial-scale=1" name=viewport>
<link href=/style/style.css rel=stylesheet>
<link href=/style/a11y.css rel=stylesheet>
<link href=/favicon.svg rel=icon type=image/svg+xml>
<script src=/scripts/image_loader.js></script>
<script src=/scripts/tex-mml-chtml.js defer></script>
<script>window.MathJax={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],processEscapes:!0}}</script>
<title>compression - rambling</title>
</head>
<body>
<nav class=site-nav id=nav>
<a href=/ >home</a>
<a href=/posts>posts</a>
<a href=/puzzles>puzzles</a>
<div id=lights-container>
<label title="toggle light/dark mode. only persistent with javascript">
<input id=lights type=checkbox>
lights
<script src=/scripts/lights.js></script>
</label>
</div>
</nav>
<div class=template-body>
<noscript class=noscript-warning>
Javascript is necessary for displaying LaTeX, some demos that run algorithms directly on the page, and small cosmetic features like light/dark mode.
</noscript>
<nav class=posts-nav_top>
<div class=posts-nav_before><a href=/./posts/13>&lt; compression - huffman coding</a></div> <div class=posts-nav_after><a href=/./posts/15>first time aws user here &gt;</a></div>
</nav>
<h1 id=compression---rambling>compression - rambling</h1>
<p>Warning.</p>
<h2 id=is-this-a-valid-idea>is this a valid idea</h2>
<p>So my understanding is that data is more easily compressed the less random it is. However, there is overhead for storing the decompression data, in the Huffman case, the tree (well also the decompression script counts towards overhead, too I guess).</p>
<p>However, it stands to reason that it's possible to make the data less random by splitting it up.</p>
<h2 id=lets-try-it>let's try it</h2>
<p>Consider the string <code>5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</code> - it looks quite random doesn't it? And compressing it using Huffman coding ends up giving values like this:</p>
<pre class=code-block><input id=code-block-14-1 type=checkbox><label for=code-block-14-1></label><code>Unencoded Length: <span class=hljs-number>256</span>
Unencoded: 0011010101100100001100100110101100110110011000110011001101110001001100010110010001110111001101010111100000110010011110010011100101110011011110010011001101111010001101000011101001110110011011100110100001111000001101100111001000111001001101100111010000111000
Encoded Length: <span class=hljs-number>371</span>
Encoded: <span class=hljs-number>11110011110100001100101000110011000110101110001110010011001001001111000001111001111100011000100011010010001110000001110101100110001100110100010011010110011011101110011100010011100101001110011001110100110011101100011101110001101100011010100011011011111010000101100010000010111101001101100001011101001101001110010000010001100111110010111101010110111111001010011111101110010</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
</code></pre>
<p>We can see that trying to compress it has actually increased the size from 256 to 371 bytes. But let's try modifying our script from the last part to chunk the data to various sizes and get the chunk size that gives us the smallest compressed data size; something quick like this:</p>
<pre class=code-block><input id=code-block-14-2 type=checkbox><label for=code-block-14-2></label><code>best_chunk_size = <span class=hljs-built_in>len</span>(data)
best_encoded_size = <span class=hljs-number>371</span>
<span class=hljs-keyword>for</span> i <span class=hljs-keyword>in</span> <span class=hljs-built_in>range</span>(<span class=hljs-number>2</span>, <span class=hljs-built_in>len</span>(data)):
    total_encoded_size = <span class=hljs-number>0</span>
    chunks = [data[x:x + i] <span class=hljs-keyword>for</span> x <span class=hljs-keyword>in</span> <span class=hljs-built_in>range</span>(<span class=hljs-number>0</span>, <span class=hljs-built_in>len</span>(data), i)]
    <span class=hljs-keyword>for</span> chunk <span class=hljs-keyword>in</span> chunks
        <span class=hljs-comment># normal processing logic</span>
        total_encoded_size = total_encoded_size + <span class=hljs-built_in>len</span>(encoded)
    <span class=hljs-keyword>if</span> total_encoded_size &lt; best_encoded_size:
        best_chunk_size = i
        best_encoded_size = total_encoded_size
</code></pre>
<p>It turns out that breaking it out into chunks of 2 is actually a lot more efficient.</p>
<pre class=code-block><input id=code-block-14-3 type=checkbox><label for=code-block-14-3></label><code>Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0011010101100100
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011010100110010001</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: 5d

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0011001001101011
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011001000110101101</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: 2k

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0011011001100011
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011011000110001101</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: 6c

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0011001101110001
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011001100111000101</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: 3q

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0011000101100100
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011000100110010001</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: 1d

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0111011100110101
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011010100111011110</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: w5

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0111100000110010
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011001000111100010</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: x2

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0111100100111001
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011100100111100110</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: y9

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0111001101111001
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100111001100111100101</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: sy

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0011001101111010
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011001100111101001</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: 3z

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0011010000111010
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011010000011101001</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: <span class=hljs-number>4</span>:

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0111011001101110
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100110111000111011010</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: vn

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0110100001111000
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100110100000111100001</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: hx

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0011011001110010
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011011000111001001</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: 6r

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0011100100110110
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011011000011100110</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: <span class=hljs-number>96</span>

Unencoded Length: <span class=hljs-number>16</span>
Unencoded: 0111010000111000
Encoded Length: <span class=hljs-number>21</span>
Encoded: <span class=hljs-number>100011100000111010010</span>
Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
Decoded: t8
</code></pre>
<p>We were able to cut the data down to 336 bits, compared to the original 371, but it was still worse than the original unencoded length of 256. Also this is when I realized there seemed to be a missing case for encoding when there was only 1 symbol. But that's not important considering what I'm about to explain.</p>
<p>First, let's determine the size of the encoding of the binary tree relative to the number of symbols. We know that there will be $1:1$ relationship between the number of nodes and the number of 1 and 0 bits in the encoding. We also know that there will be $8*len(symbols)$ of bits to encode the symbol data for the tree (assuming we're using chars which are 1 byte long). We also know that we will always have a full binary tree because we build from the leaves up, so let's find a relationship between number of nodes in a full binary tree and number of leaves. Examples are good to look at.</p>
<p>
</p><div class=tikz-picture style=height:64.41866pt>
<svg height=64.41866pt viewBox="-72 -72 64.41866 64.41866" width=64.41866pt><g transform="translate(-40.06069946289062,-61.40023803710936) scale(1,-1)"><g> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g stroke-width=0.4pt> <g> <g> <path d=" M  10.66977 0.0 C  10.66977 5.89282 5.89282 10.66977 0.0 10.66977 C  -5.89282 10.66977 -10.66977 5.89282 -10.66977 0.0 C  -10.66977 -5.89282 -5.89282 -10.66977 0.0 -10.66977 C  5.89282 -10.66977 10.66977 -5.89282 10.66977 0.0 Z M  0.0 0.0  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,0.0,0.0)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <g> <g> <path d=" M  -10.66977 -42.67912 C  -10.66977 -36.7863 -15.44672 -32.00935 -21.33954 -32.00935 C  -27.23236 -32.00935 -32.00931 -36.7863 -32.00931 -42.67912 C  -32.00931 -48.57195 -27.23236 -53.34889 -21.33954 -53.34889 C  -15.44672 -53.34889 -10.66977 -48.57195 -10.66977 -42.67912 Z M  -21.33954 -42.67912  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,-21.33954,-42.67912)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  -4.8615 -9.72218 L  -16.272 -32.54388  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,-16.272,-32.54387)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  32.00935 -42.67912 C  32.00935 -36.7863 27.2324 -32.00935 21.33958 -32.00935 C  15.44676 -32.00935 10.66982 -36.7863 10.66982 -42.67912 C  10.66982 -48.57195 15.44676 -53.34889 21.33958 -53.34889 C  27.2324 -53.34889 32.00935 -48.57195 32.00935 -42.67912 Z M  21.33958 -42.67912  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,21.33958,-42.67912)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  4.8615 -9.72218 L  16.27205 -32.54388  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,16.27205,-32.54387)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g></svg>
</div>
<p></p>
<p><br></p>
<p>
</p><div class=tikz-picture style=height:107.09778pt>
<svg height=107.09778pt viewBox="-72 -72 85.75824 107.09778" width=85.75824pt><g transform="translate(-40.06069946289062,-61.40023803710936) scale(1,-1)"><g> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g stroke-width=0.4pt> <g> <g> <path d=" M  10.66977 0.0 C  10.66977 5.89282 5.89282 10.66977 0.0 10.66977 C  -5.89282 10.66977 -10.66977 5.89282 -10.66977 0.0 C  -10.66977 -5.89282 -5.89282 -10.66977 0.0 -10.66977 C  5.89282 -10.66977 10.66977 -5.89282 10.66977 0.0 Z M  0.0 0.0  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,0.0,0.0)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <g> <g> <path d=" M  -10.66977 -42.67912 C  -10.66977 -36.7863 -15.44672 -32.00935 -21.33954 -32.00935 C  -27.23236 -32.00935 -32.00931 -36.7863 -32.00931 -42.67912 C  -32.00931 -48.57195 -27.23236 -53.34889 -21.33954 -53.34889 C  -15.44672 -53.34889 -10.66977 -48.57195 -10.66977 -42.67912 Z M  -21.33954 -42.67912  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,-21.33954,-42.67912)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  -4.8615 -9.72218 L  -16.272 -32.54388  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,-16.272,-32.54387)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  32.00935 -42.67912 C  32.00935 -36.7863 27.2324 -32.00935 21.33958 -32.00935 C  15.44676 -32.00935 10.66982 -36.7863 10.66982 -42.67912 C  10.66982 -48.57195 15.44676 -53.34889 21.33958 -53.34889 C  27.2324 -53.34889 32.00935 -48.57195 32.00935 -42.67912 Z M  21.33958 -42.67912  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,21.33958,-42.67912)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  4.8615 -9.72218 L  16.27205 -32.54388  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,16.27205,-32.54387)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  10.66982 -85.35825 C  10.66982 -79.46542 5.89287 -74.68848 0.00005 -74.68848 C  -5.89278 -74.68848 -10.66972 -79.46542 -10.66972 -85.35825 C  -10.66972 -91.25107 -5.89278 -96.02802 0.00005 -96.02802 C  5.89287 -96.02802 10.66982 -91.25107 10.66982 -85.35825 Z M  0.00005 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,0.00005,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  16.47809 -52.4013 L  5.06758 -75.223  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,5.06758,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  53.34894 -85.35825 C  53.34894 -79.46542 48.57199 -74.68848 42.67917 -74.68848 C  36.78635 -74.68848 32.0094 -79.46542 32.0094 -85.35825 C  32.0094 -91.25107 36.78635 -96.02802 42.67917 -96.02802 C  48.57199 -96.02802 53.34894 -91.25107 53.34894 -85.35825 Z M  42.67917 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,42.67917,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  26.20108 -52.4013 L  37.61163 -75.223  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,37.61163,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g></svg>
</div>
<p></p>
<p><br></p>
<p>
</p><div class=tikz-picture style=height:107.09778pt>
<svg height=107.09778pt viewBox="-72 -72 149.77692 107.09778" width=149.77692pt><g transform="translate(2.6184082031249996,-61.40023803710936) scale(1,-1)"><g> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g stroke-width=0.4pt> <g> <g> <path d=" M  10.66977 0.0 C  10.66977 5.89282 5.89282 10.66977 0.0 10.66977 C  -5.89282 10.66977 -10.66977 5.89282 -10.66977 0.0 C  -10.66977 -5.89282 -5.89282 -10.66977 0.0 -10.66977 C  5.89282 -10.66977 10.66977 -5.89282 10.66977 0.0 Z M  0.0 0.0  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,0.0,0.0)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <g> <g> <path d=" M  -32.00934 -42.67912 C  -32.00934 -36.7863 -36.78629 -32.00935 -42.67911 -32.00935 C  -48.57193 -32.00935 -53.34888 -36.7863 -53.34888 -42.67912 C  -53.34888 -48.57195 -48.57193 -53.34889 -42.67911 -53.34889 C  -36.78629 -53.34889 -32.00934 -48.57195 -32.00934 -42.67912 Z M  -42.67911 -42.67912  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,-42.67911,-42.67912)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  -7.68608 -7.68608 L  -34.6676 -34.66779  " style=fill:none /> <g> <g transform=matrix(-0.70709,-0.7071,0.7071,-0.70709,-34.6676,-34.66779)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  -53.34888 -85.35825 C  -53.34888 -79.46542 -58.12582 -74.68848 -64.01865 -74.68848 C  -69.91147 -74.68848 -74.68842 -79.46542 -74.68842 -85.35825 C  -74.68842 -91.25107 -69.91147 -96.02802 -64.01865 -96.02802 C  -58.12582 -96.02802 -53.34888 -91.25107 -53.34888 -85.35825 Z M  -64.01865 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,-64.01865,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  -47.5406 -52.4013 L  -58.95111 -75.223  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,-58.95111,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  -10.66975 -85.35825 C  -10.66975 -79.46542 -15.4467 -74.68848 -21.33952 -74.68848 C  -27.23235 -74.68848 -32.0093 -79.46542 -32.0093 -85.35825 C  -32.0093 -91.25107 -27.23235 -96.02802 -21.33952 -96.02802 C  -15.4467 -96.02802 -10.66975 -91.25107 -10.66975 -85.35825 Z M  -21.33952 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,-21.33952,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  -37.81761 -52.4013 L  -26.40706 -75.223  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,-26.40706,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  53.34892 -42.67912 C  53.34892 -36.7863 48.57198 -32.00935 42.67915 -32.00935 C  36.78633 -32.00935 32.00938 -36.7863 32.00938 -42.67912 C  32.00938 -48.57195 36.78633 -53.34889 42.67915 -53.34889 C  48.57198 -53.34889 53.34892 -48.57195 53.34892 -42.67912 Z M  42.67915 -42.67912  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,42.67915,-42.67912)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  7.68608 -7.68608 L  34.66782 -34.66762  " style=fill:none /> <g> <g transform=matrix(0.7071,-0.70709,0.70709,0.7071,34.66782,-34.66762)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  32.00938 -85.35825 C  32.00938 -79.46542 27.23244 -74.68848 21.33961 -74.68848 C  15.4468 -74.68848 10.66985 -79.46542 10.66985 -85.35825 C  10.66985 -91.25107 15.4468 -96.02802 21.33961 -96.02802 C  27.23244 -96.02802 32.00938 -91.25107 32.00938 -85.35825 Z M  21.33961 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,21.33961,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  37.81766 -52.4013 L  26.40715 -75.223  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,26.40715,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  74.6885 -85.35825 C  74.6885 -79.46542 69.91156 -74.68848 64.01874 -74.68848 C  58.12592 -74.68848 53.34897 -79.46542 53.34897 -85.35825 C  53.34897 -91.25107 58.12592 -96.02802 64.01874 -96.02802 C  69.91156 -96.02802 74.6885 -91.25107 74.6885 -85.35825 Z M  64.01874 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,64.01874,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  47.54065 -52.4013 L  58.9512 -75.223  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,58.9512,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g></svg>
</div>
<p></p>
<p><br></p>
<p>
</p><div class=tikz-picture style=height:149.7769pt>
<svg height=149.7769pt viewBox="-72 -72 171.1165 149.7769" width=171.1165pt><g transform="translate(2.6184082031249996,-61.40023803710936) scale(1,-1)"><g> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g stroke-width=0.4pt> <g> <g> <path d=" M  10.66977 0.0 C  10.66977 5.89282 5.89282 10.66977 0.0 10.66977 C  -5.89282 10.66977 -10.66977 5.89282 -10.66977 0.0 C  -10.66977 -5.89282 -5.89282 -10.66977 0.0 -10.66977 C  5.89282 -10.66977 10.66977 -5.89282 10.66977 0.0 Z M  0.0 0.0  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,0.0,0.0)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <g> <g> <path d=" M  -32.00934 -42.67912 C  -32.00934 -36.7863 -36.78629 -32.00935 -42.67911 -32.00935 C  -48.57193 -32.00935 -53.34888 -36.7863 -53.34888 -42.67912 C  -53.34888 -48.57195 -48.57193 -53.34889 -42.67911 -53.34889 C  -36.78629 -53.34889 -32.00934 -48.57195 -32.00934 -42.67912 Z M  -42.67911 -42.67912  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,-42.67911,-42.67912)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  -7.68608 -7.68608 L  -34.6676 -34.66779  " style=fill:none /> <g> <g transform=matrix(-0.70709,-0.7071,0.7071,-0.70709,-34.6676,-34.66779)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  -53.34888 -85.35825 C  -53.34888 -79.46542 -58.12582 -74.68848 -64.01865 -74.68848 C  -69.91147 -74.68848 -74.68842 -79.46542 -74.68842 -85.35825 C  -74.68842 -91.25107 -69.91147 -96.02802 -64.01865 -96.02802 C  -58.12582 -96.02802 -53.34888 -91.25107 -53.34888 -85.35825 Z M  -64.01865 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,-64.01865,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  -47.5406 -52.4013 L  -58.95111 -75.223  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,-58.95111,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  -10.66975 -85.35825 C  -10.66975 -79.46542 -15.4467 -74.68848 -21.33952 -74.68848 C  -27.23235 -74.68848 -32.0093 -79.46542 -32.0093 -85.35825 C  -32.0093 -91.25107 -27.23235 -96.02802 -21.33952 -96.02802 C  -15.4467 -96.02802 -10.66975 -91.25107 -10.66975 -85.35825 Z M  -21.33952 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,-21.33952,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  -37.81761 -52.4013 L  -26.40706 -75.223  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,-26.40706,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  53.34892 -42.67912 C  53.34892 -36.7863 48.57198 -32.00935 42.67915 -32.00935 C  36.78633 -32.00935 32.00938 -36.7863 32.00938 -42.67912 C  32.00938 -48.57195 36.78633 -53.34889 42.67915 -53.34889 C  48.57198 -53.34889 53.34892 -48.57195 53.34892 -42.67912 Z M  42.67915 -42.67912  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,42.67915,-42.67912)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  7.68608 -7.68608 L  34.66782 -34.66762  " style=fill:none /> <g> <g transform=matrix(0.7071,-0.70709,0.70709,0.7071,34.66782,-34.66762)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  32.00938 -85.35825 C  32.00938 -79.46542 27.23244 -74.68848 21.33961 -74.68848 C  15.4468 -74.68848 10.66985 -79.46542 10.66985 -85.35825 C  10.66985 -91.25107 15.4468 -96.02802 21.33961 -96.02802 C  27.23244 -96.02802 32.00938 -91.25107 32.00938 -85.35825 Z M  21.33961 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,21.33961,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  37.81766 -52.4013 L  26.40715 -75.223  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,26.40715,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  74.6885 -85.35825 C  74.6885 -79.46542 69.91156 -74.68848 64.01874 -74.68848 C  58.12592 -74.68848 53.34897 -79.46542 53.34897 -85.35825 C  53.34897 -91.25107 58.12592 -96.02802 64.01874 -96.02802 C  69.91156 -96.02802 74.6885 -91.25107 74.6885 -85.35825 Z M  64.01874 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,64.01874,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  47.54065 -52.4013 L  58.9512 -75.223  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,58.9512,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  53.34897 -128.03737 C  53.34897 -122.14455 48.57202 -117.3676 42.6792 -117.3676 C  36.78638 -117.3676 32.00943 -122.14455 32.00943 -128.03737 C  32.00943 -133.93019 36.78638 -138.70714 42.6792 -138.70714 C  48.57202 -138.70714 53.34897 -133.93019 53.34897 -128.03737 Z M  42.6792 -128.03737  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,42.6792,-128.03737)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  59.15724 -95.08043 L  47.74673 -117.90213  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,47.74673,-117.90211)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  96.02809 -128.03737 C  96.02809 -122.14455 91.25114 -117.3676 85.35832 -117.3676 C  79.4655 -117.3676 74.68855 -122.14455 74.68855 -128.03737 C  74.68855 -133.93019 79.4655 -138.70714 85.35832 -138.70714 C  91.25114 -138.70714 96.02809 -133.93019 96.02809 -128.03737 Z M  85.35832 -128.03737  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,85.35832,-128.03737)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(2.6184082031249996,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  68.88023 -95.08043 L  80.29079 -117.90213  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,80.29079,-117.90211)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g></svg>
</div>
<p></p>
<p><br></p>
<table>
<thead>
<tr>
<th>Leaves</th>
<th>total nodes</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>3</td>
<td>5</td>
</tr>
<tr>
<td>4</td>
<td>7</td>
</tr>
<tr>
<td>5</td>
<td>9</td>
</tr>
</tbody>
</table>
<p>And we should be able to see that we the pattern is $n = 2l - 1$. And remember, the number of leaves is equal to the number of symbols.</p>
<p>Let $s$ be the number of distinct symbols in the data</p>
<p>$$ \begin{align} 8 * len(symbols) + 2 * len(symbols) - 1 = 10 * len(symbols) - 1 \end{align} $$</p>
<p>So it takes $10 * s - 1$ bits to encode the binary tree (double check that…). Now we need to think about how the data is actually encoded.</p>
<p>There is one obvious point where the encoding is no longer worth it, and that is when the encoding for a node ends up being <em>at least</em> 8 bits long - or in other words the depth the leaf nodes of the tree are all at least 8.</p>
<p>This definitely requires a lot more thought and analysis than my ramble is calling for, but the idea is that there should be some ratio between the occurrence of shorter encoded symbols and longer encoded symbols that, once surpassed, can show Huffman coding to be inefficient. The idea is that a tree like the following:</p>
<p>
</p><div class=tikz-picture style=height:192.45602pt>
<svg height=192.45602pt viewBox="-72 -72 128.43741 192.45602" width=128.43741pt><g transform="translate(-40.06069946289062,-61.40023803710936) scale(1,-1)"><g> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g stroke-width=0.4pt> <g> <g> <path d=" M  10.66977 0.0 C  10.66977 5.89282 5.89282 10.66977 0.0 10.66977 C  -5.89282 10.66977 -10.66977 5.89282 -10.66977 0.0 C  -10.66977 -5.89282 -5.89282 -10.66977 0.0 -10.66977 C  5.89282 -10.66977 10.66977 -5.89282 10.66977 0.0 Z M  0.0 0.0  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,0.0,0.0)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <g> <g> <path d=" M  -10.66977 -42.67912 C  -10.66977 -36.7863 -15.44672 -32.00935 -21.33954 -32.00935 C  -27.23236 -32.00935 -32.00931 -36.7863 -32.00931 -42.67912 C  -32.00931 -48.57195 -27.23236 -53.34889 -21.33954 -53.34889 C  -15.44672 -53.34889 -10.66977 -48.57195 -10.66977 -42.67912 Z M  -21.33954 -42.67912  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,-25.08954,-46.09578)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none><text alignment-baseline=baseline fill=black font-family=cmr10 font-size=10 x=-40.06069946289062 y=-61.40023803710936>A</text></g></g> </g> </g> </g> </g> <path d=" M  -4.8615 -9.72218 L  -16.272 -32.54388  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,-16.272,-32.54387)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  32.00935 -42.67912 C  32.00935 -36.7863 27.2324 -32.00935 21.33958 -32.00935 C  15.44676 -32.00935 10.66982 -36.7863 10.66982 -42.67912 C  10.66982 -48.57195 15.44676 -53.34889 21.33958 -53.34889 C  27.2324 -53.34889 32.00935 -48.57195 32.00935 -42.67912 Z M  21.33958 -42.67912  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,21.33958,-42.67912)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  4.8615 -9.72218 L  16.27205 -32.54388  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,16.27205,-32.54387)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  10.66982 -85.35825 C  10.66982 -79.46542 5.89287 -74.68848 0.00005 -74.68848 C  -5.89278 -74.68848 -10.66972 -79.46542 -10.66972 -85.35825 C  -10.66972 -91.25107 -5.89278 -96.02802 0.00005 -96.02802 C  5.89287 -96.02802 10.66982 -91.25107 10.66982 -85.35825 Z M  0.00005 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,0.00005,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  16.47809 -52.4013 L  5.06758 -75.223  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,5.06758,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  53.34894 -85.35825 C  53.34894 -79.46542 48.57199 -74.68848 42.67917 -74.68848 C  36.78635 -74.68848 32.0094 -79.46542 32.0094 -85.35825 C  32.0094 -91.25107 36.78635 -96.02802 42.67917 -96.02802 C  48.57199 -96.02802 53.34894 -91.25107 53.34894 -85.35825 Z M  42.67917 -85.35825  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,42.67917,-85.35825)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  26.20108 -52.4013 L  37.61163 -75.223  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,37.61163,-75.22299)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  32.0094 -128.03737 C  32.0094 -122.14455 27.23245 -117.3676 21.33963 -117.3676 C  15.44681 -117.3676 10.66986 -122.14455 10.66986 -128.03737 C  10.66986 -133.93019 15.44681 -138.70714 21.33963 -138.70714 C  27.23245 -138.70714 32.0094 -133.93019 32.0094 -128.03737 Z M  21.33963 -128.03737  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,21.33963,-128.03737)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  37.81767 -95.08043 L  26.40717 -117.90213  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,26.40717,-117.90211)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  74.68852 -128.03737 C  74.68852 -122.14455 69.91158 -117.3676 64.01875 -117.3676 C  58.12593 -117.3676 53.34898 -122.14455 53.34898 -128.03737 C  53.34898 -133.93019 58.12593 -138.70714 64.01875 -138.70714 C  69.91158 -138.70714 74.68852 -133.93019 74.68852 -128.03737 Z M  64.01875 -128.03737  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,64.01875,-128.03737)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  47.54066 -95.08043 L  58.95122 -117.90213  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,58.95122,-117.90211)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  53.34898 -170.71649 C  53.34898 -164.82367 48.57204 -160.04672 42.67921 -160.04672 C  36.78639 -160.04672 32.00945 -164.82367 32.00945 -170.71649 C  32.00945 -176.60931 36.78639 -181.38626 42.67921 -181.38626 C  48.57204 -181.38626 53.34898 -176.60931 53.34898 -170.71649 Z M  42.67921 -170.71649  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,42.67921,-170.71649)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  59.15726 -137.75955 L  47.74675 -160.58125  " style=fill:none /> <g> <g transform=matrix(-0.44899,-0.898,0.898,-0.44899,47.74675,-160.58124)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> <g> <g> <path d=" M  96.0281 -170.71649 C  96.0281 -164.82367 91.25116 -160.04672 85.35834 -160.04672 C  79.46552 -160.04672 74.68857 -164.82367 74.68857 -170.71649 C  74.68857 -176.60931 79.46552 -181.38626 85.35834 -181.38626 C  91.25116 -181.38626 96.0281 -176.60931 96.0281 -170.71649 Z M  85.35834 -170.71649  " style=fill:none /> <g> <g transform=matrix(1.0,0.0,0.0,1.0,85.35834,-170.71649)> <g stroke=rgb(0.0%,0.0%,0.0%)> <g fill=rgb(0.0%,0.0%,0.0%)> <g transform="scale(-1,1) translate(-40.06069946289062,-61.40023803710936) scale(-1,-1)" stroke=none></g></g> </g> </g> </g> </g> <path d=" M  68.88025 -137.75955 L  80.2908 -160.58125  " style=fill:none /> <g> <g transform=matrix(0.44899,-0.898,0.898,0.44899,80.2908,-160.58124)> <g> <g stroke-width=0.31999pt> <g stroke-dasharray=none stroke-dashoffset=0.0pt> <g stroke-linecap=round> <g stroke-linejoin=round> <path d=" M  -1.19998 1.59998 C  -1.09998 0.99998 0.0 0.09999 0.29999 0.0 C  0.0 -0.09999 -1.09998 -0.99998 -1.19998 -1.59998  " style=fill:none /> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g> </g></svg>
</div>
<p></p>
<p>But extended far and deep to the right. We can see that $A$ only takes one bit to encode but the symbols much lower down will - possibly - a lot more than 8 bits to encode, so for Huffman coding to be efficient, there needs to be a certain amount of more $A$s compared to the ones down there - intuition says the ratio is also related to the difference in bit encoding lengths.</p>
<p>I think the ramble has gone on for some time, so I'd like to just end with one example where chunking beats the unencoded while chunking doesn't - when the data is $ABCABCDEFDEFGHIGHI$.</p>
<p>Just by looking at it, you can already guess that a good chunk size is going to be 6, and it turns out that is what is best. If we go with encoding the entire thing, we get</p>
<pre class=code-block><input id=code-block-14-4 type=checkbox><label for=code-block-14-4></label><code>Unencoded Length: <span class=hljs-number>144</span>
Unencoded: <span class=hljs-number>0</span>10000010100001001000011010000010100001001000011010001000100010101000110010001000100010101000110010001110100100001001001010001110100100001001001
Encoded Length: <span class=hljs-number>147</span>
Encoded: <span class=hljs-number>111001000011001000100100100010100100011011001000111001001000100100100110010000010010000101110111100011101111000001010011001010011100101110100101110</span>
Data: ABCABCDEFDEFGHIGHI
Decoded: ABCABCDEFDEFGHIGHI
</code></pre>
<p>3 more bits! But chunking it down to chunks of 6, we get</p>
<pre class=code-block><input id=code-block-14-5 type=checkbox><label for=code-block-14-5></label><code>Unencoded Length: <span class=hljs-number>48</span>
Unencoded: <span class=hljs-number>0</span>10000010100001001000011010000010100001001000011
Encoded Length: <span class=hljs-number>39</span>
Encoded: <span class=hljs-number>100100001110010000010010000101011010110</span>
Data: ABCABCDEFDEFGHIGHI
Decoded: ABCABC

Unencoded Length: <span class=hljs-number>48</span>
Unencoded: <span class=hljs-number>0</span>10001000100010101000110010001000100010101000110
Encoded Length: <span class=hljs-number>39</span>
Encoded: <span class=hljs-number>100100011010010001000010001011011010110</span>
Data: ABCABCDEFDEFGHIGHI
Decoded: DEFDEF

Unencoded Length: <span class=hljs-number>48</span>
Unencoded: <span class=hljs-number>0</span>10001110100100001001001010001110100100001001001
Encoded Length: <span class=hljs-number>39</span>
Encoded: <span class=hljs-number>100100100110010001110010010001011010110</span>
Data: ABCABCDEFDEFGHIGHI
Decoded: GHIGHI
</code></pre>
<p>117 bits! An improvement of 27 bits!</p>
<h2 id=further-reading>further reading</h2>
<p>Looking at the
<a href=https://en.wikipedia.org/wiki/Huffman_coding>wikipedia page for Huffman coding</a>, there are two other algorithms mentioned:
<a href=https://en.wikipedia.org/wiki/Arithmetic_coding>arithmetic coding</a> and
<a href=https://en.wikipedia.org/wiki/Asymmetric_numeral_systems>asymmetric numeral systems</a>. Pretty interesting stuff.</p>
<p>Also this <a href=http://fastcompression.blogspot.com/ >blog</a> is very informative of other related topics.</p>
<p>Ramble over.</p>
<nav class=posts-nav_bottom>
<div class=posts-nav_before><a href=/./posts/13>&lt; compression - huffman coding</a></div> <div class=posts-nav_after><a href=/./posts/15>first time aws user here &gt;</a></div>
</nav>
<div class=commit-container>
<div class="commit-list de-emphasized">
<span>History:</span>
<details>
<summary>2020-11-18 - rename some posts</summary>
<pre class=code-block><input id=code-block-676e04c7c5ba7f50055b0ede6c828f4edacf5964-1 type=checkbox><label for=code-block-676e04c7c5ba7f50055b0ede6c828f4edacf5964-1></label><code><span class=hljs-meta>@@ -1,2 +1,2 @@</span>
<span class=hljs-deletion>-# compression - pt 2 - rambling</span>
<span class=hljs-addition>+# compression - rambling</span>
</code></pre>
</details>
<details>
<summary>2020-08-06 - aws</summary>
<pre class=code-block><input id=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-1 type=checkbox><label for=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-1></label><code><span class=hljs-meta>@@ -15,3 +15,3 @@</span> splitting it up.

<span class=hljs-deletion>-Consider the string $5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8$ - it looks quite random doesn&#x27;t</span>
<span class=hljs-addition>+Consider the string `5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8` - it looks quite random doesn&#x27;t</span>
 it? And compressing it using Huffman coding ends up giving values like this:
</code></pre>
<pre class=code-block><input id=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-2 type=checkbox><label for=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-2></label><code><span class=hljs-meta>@@ -183,3 +183,3 @@</span> good to look at.
 &lt;/script&gt;
<span class=hljs-deletion>-</span>
<span class=hljs-addition>+&lt;br&gt;</span>
 &lt;script type=&quot;text/tikz&quot;&gt;
</code></pre>
<pre class=code-block><input id=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-3 type=checkbox><label for=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-3></label><code><span class=hljs-meta>@@ -193,3 +193,3 @@</span> good to look at.
 &lt;/script&gt;
<span class=hljs-deletion>-</span>
<span class=hljs-addition>+&lt;br&gt;</span>
 &lt;script type=&quot;text/tikz&quot;&gt;
</code></pre>
<pre class=code-block><input id=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-4 type=checkbox><label for=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-4></label><code><span class=hljs-meta>@@ -209,3 +209,3 @@</span> good to look at.
 &lt;/script&gt;
<span class=hljs-deletion>-</span>
<span class=hljs-addition>+&lt;br&gt;</span>
 &lt;script type=&quot;text/tikz&quot;&gt;
</code></pre>
<pre class=code-block><input id=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-5 type=checkbox><label for=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-5></label><code><span class=hljs-meta>@@ -228,2 +228,3 @@</span> good to look at.
 &lt;/script&gt;
<span class=hljs-addition>+&lt;br&gt;</span>
</code></pre>
<pre class=code-block><input id=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-6 type=checkbox><label for=code-block-f986f83322b2a2b3e8e4f447a3357730f208f2a2-6></label><code><span class=hljs-meta>@@ -245,3 +246,3 @@</span> $$
 \begin{align}
<span class=hljs-deletion>-8 * s + 2 * s - 1 = 10 * s - 1</span>
<span class=hljs-addition>+8 * len(symbols) + 2 * len(symbols) - 1 = 10 * len(symbols) - 1</span>
 \end{align}
</code></pre>
</details>
<details>
<summary>2020-07-28 - add some content</summary>
<pre class=code-block><input id=code-block-2083d8a95cf4f9309739ef74c6839afcc5abfbf6-1 type=checkbox><label for=code-block-2083d8a95cf4f9309739ef74c6839afcc5abfbf6-1></label><code><span class=hljs-meta>@@ -336,2 +336,5 @@</span> Pretty interesting stuff.

<span class=hljs-addition>+Also this [blog](http://fastcompression.blogspot.com/) is very informative of other</span>
<span class=hljs-addition>+related topics.</span>
<span class=hljs-addition>+</span>
 Ramble over.
</code></pre>
</details>
<details>
<summary>2020-07-28 - fix some spacing</summary>
<pre class=code-block><input id=code-block-37c86106fb16d6c9a0ff050a0bce0f2402a4526a-1 type=checkbox><label for=code-block-37c86106fb16d6c9a0ff050a0bce0f2402a4526a-1></label><code><span class=hljs-meta>@@ -19,8 +19,8 @@</span> it? And compressing it using Huffman coding ends up giving values like this:
</code></pre>
<p>python</p>
<ul>
<li>Unencoded Length: 256</li>
<li>Unencoded: 0011010101100100001100100110101100110110011000110011001101110001001100010110010001110111001101010111100000110010011110010011100101110011011110010011001101111010001101000011101001110110011011100110100001111000001101100111001000111001001101100111010000111000</li>
<li>Encoded Length: 371</li>
<li>Encoded: 11110011110100001100101000110011000110101110001110010011001001001111000001111001111100011000100011010010001110000001110101100110001100110100010011010110011011101110011100010011100101001110011001110100110011101100011101110001101100011010100011011011111010000101100010000010111101001101100001011101001101001110010000010001100111110010111101010110111111001010011111101110010</li>
<li>Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</li>
<li>Decoded: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8 +Unencoded Length: 256 +Unencoded: 0011010101100100001100100110101100110110011000110011001101110001001100010110010001110111001101010111100000110010011110010011100101110011011110010011001101111010001101000011101001110110011011100110100001111000001101100111001000111001001101100111010000111000 +Encoded Length: 371 +Encoded: 11110011110100001100101000110011000110101110001110010011001001001111000001111001111100011000100011010010001110000001110101100110001100110100010011010110011011101110011100010011100101001110011001110100110011101100011101110001101100011010100011011011111010000101100010000010111101001101100001011101001101001110010000010001100111110010111101010110111111001010011111101110010 +Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8 +Decoded: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8
<code>
</code></li>
</ul>
</details>
<details>
<summary>2020-07-28 - compression pt 2</summary>
<pre class=code-block><input id=code-block-0ae0ebbcd008f5dd4a246e6cbff8612df63fd38f-1 type=checkbox><label for=code-block-0ae0ebbcd008f5dd4a246e6cbff8612df63fd38f-1></label><code><span class=hljs-meta>@@ -0,0 +1,337 @@</span>
<span class=hljs-addition>+# compression - pt 2 - rambling</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Warning.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+## is this a valid idea</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+So my understanding is that data is more easily compressed the less random it is.</span>
<span class=hljs-addition>+However, there is overhead for storing the decompression data, in the Huffman case,</span>
<span class=hljs-addition>+the tree (well also the decompression script counts towards overhead, too I guess).</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+However, it stands to reason that it&#x27;s possible to make the data less random by</span>
<span class=hljs-addition>+splitting it up.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+## let&#x27;s try it</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Consider the string $5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8$ - it looks quite random doesn&#x27;t</span>
<span class=hljs-addition>+it? And compressing it using Huffman coding ends up giving values like this:</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+```python</span>
<span class=hljs-addition>+    Unencoded Length: 256</span>
<span class=hljs-addition>+    Unencoded: 0011010101100100001100100110101100110110011000110011001101110001001100010110010001110111001101010111100000110010011110010011100101110011011110010011001101111010001101000011101001110110011011100110100001111000001101100111001000111001001101100111010000111000</span>
<span class=hljs-addition>+    Encoded Length: 371</span>
<span class=hljs-addition>+    Encoded: 11110011110100001100101000110011000110101110001110010011001001001111000001111001111100011000100011010010001110000001110101100110001100110100010011010110011011101110011100010011100101001110011001110100110011101100011101110001101100011010100011011011111010000101100010000010111101001101100001011101001101001110010000010001100111110010111101010110111111001010011111101110010</span>
<span class=hljs-addition>+    Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+    Decoded: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+```</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+We can see that trying to compress it has actually increased the size from 256 to</span>
<span class=hljs-addition>+371 bytes. But let&#x27;s try modifying our script from the last part to chunk the data</span>
<span class=hljs-addition>+to various sizes and get the chunk size that gives us the smallest compressed data</span>
<span class=hljs-addition>+size; something quick like this:</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+```python</span>
<span class=hljs-addition>+best_chunk_size = len(data)</span>
<span class=hljs-addition>+best_encoded_size = 371</span>
<span class=hljs-addition>+for i in range(2, len(data)):</span>
<span class=hljs-addition>+    total_encoded_size = 0</span>
<span class=hljs-addition>+    chunks = [data[x:x + i] for x in range(0, len(data), i)]</span>
<span class=hljs-addition>+    for chunk in chunks</span>
<span class=hljs-addition>+        # normal processing logic</span>
<span class=hljs-addition>+        total_encoded_size = total_encoded_size + len(encoded)</span>
<span class=hljs-addition>+    if total_encoded_size &lt; best_encoded_size:</span>
<span class=hljs-addition>+        best_chunk_size = i</span>
<span class=hljs-addition>+        best_encoded_size = total_encoded_size</span>
<span class=hljs-addition>+```</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+It turns out that breaking it out into chunks of 2 is actually a lot more efficient.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+```python</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0011010101100100</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011010100110010001</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: 5d</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0011001001101011</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011001000110101101</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: 2k</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0011011001100011</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011011000110001101</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: 6c</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0011001101110001</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011001100111000101</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: 3q</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0011000101100100</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011000100110010001</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: 1d</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0111011100110101</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011010100111011110</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: w5</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0111100000110010</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011001000111100010</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: x2</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0111100100111001</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011100100111100110</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: y9</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0111001101111001</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100111001100111100101</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: sy</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0011001101111010</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011001100111101001</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: 3z</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0011010000111010</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011010000011101001</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: 4:</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0111011001101110</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100110111000111011010</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: vn</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0110100001111000</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100110100000111100001</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: hx</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0011011001110010</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011011000111001001</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: 6r</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0011100100110110</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011011000011100110</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: 96</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 16</span>
<span class=hljs-addition>+Unencoded: 0111010000111000</span>
<span class=hljs-addition>+Encoded Length: 21</span>
<span class=hljs-addition>+Encoded: 100011100000111010010</span>
<span class=hljs-addition>+Data: 5d2k6c3q1dw5x2y9sy3z4:vnhx6r96t8</span>
<span class=hljs-addition>+Decoded: t8</span>
<span class=hljs-addition>+```</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+We were able to cut the data down to 336 bits, compared to the original 371,</span>
<span class=hljs-addition>+but it was still worse than the original unencoded length of 256. Also this is when</span>
<span class=hljs-addition>+I realized there seemed to be a missing case for encoding when there was only 1</span>
<span class=hljs-addition>+symbol. But that&#x27;s not important considering what I&#x27;m about to explain.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+First, let&#x27;s determine the size of the encoding of the binary tree relative to</span>
<span class=hljs-addition>+the number of symbols. We know that there will be $1:1$ relationship between the</span>
<span class=hljs-addition>+number of nodes and the number of 1 and 0 bits in the encoding. We also know that</span>
<span class=hljs-addition>+there will be $8*len(symbols)$ of bits to encode the symbol data for the tree</span>
<span class=hljs-addition>+(assuming we&#x27;re using chars which are 1 byte long). We also know that we will always</span>
<span class=hljs-addition>+have a full binary tree because we build from the leaves up, so let&#x27;s find a relationship</span>
<span class=hljs-addition>+between number of nodes in a full binary tree and number of leaves. Examples are</span>
<span class=hljs-addition>+good to look at.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+&lt;script type=&quot;text/tikz&quot;&gt;</span>
<span class=hljs-addition>+  \begin{tikzpicture}[nodes={draw, circle, minimum size=0.75cm}, -&gt;]</span>
<span class=hljs-addition>+    \node{}</span>
<span class=hljs-addition>+      child{ node{} }</span>
<span class=hljs-addition>+      child{ node {} };</span>
<span class=hljs-addition>+   \end{tikzpicture}</span>
<span class=hljs-addition>+&lt;/script&gt;</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+&lt;script type=&quot;text/tikz&quot;&gt;</span>
<span class=hljs-addition>+  \begin{tikzpicture}[nodes={draw, circle, minimum size=0.75cm}, -&gt;]</span>
<span class=hljs-addition>+    \node{}</span>
<span class=hljs-addition>+      child{ node{} }</span>
<span class=hljs-addition>+      child{ node {}</span>
<span class=hljs-addition>+        child{ node{} }</span>
<span class=hljs-addition>+        child{ node{} } };</span>
<span class=hljs-addition>+   \end{tikzpicture}</span>
<span class=hljs-addition>+&lt;/script&gt;</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+&lt;script type=&quot;text/tikz&quot;&gt;</span>
<span class=hljs-addition>+  \begin{tikzpicture}[nodes={draw, circle, minimum size=0.75cm}, -&gt;,</span>
<span class=hljs-addition>+    level 1/.style={sibling distance=30mm},</span>
<span class=hljs-addition>+    level 2/.style={sibling distance=15mm}]</span>
<span class=hljs-addition>+    \node{}</span>
<span class=hljs-addition>+      child { node {}</span>
<span class=hljs-addition>+        child { node {} }</span>
<span class=hljs-addition>+        child { node {} }</span>
<span class=hljs-addition>+      }</span>
<span class=hljs-addition>+      child { node{}</span>
<span class=hljs-addition>+        child{ node{} }</span>
<span class=hljs-addition>+        child{ node {} }</span>
<span class=hljs-addition>+      };</span>
<span class=hljs-addition>+   \end{tikzpicture}</span>
<span class=hljs-addition>+&lt;/script&gt;</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+&lt;script type=&quot;text/tikz&quot;&gt;</span>
<span class=hljs-addition>+  \begin{tikzpicture}[nodes={draw, circle, minimum size=0.75cm}, -&gt;,</span>
<span class=hljs-addition>+    level 1/.style={sibling distance=30mm},</span>
<span class=hljs-addition>+    level 2/.style={sibling distance=15mm}]</span>
<span class=hljs-addition>+    \node{}</span>
<span class=hljs-addition>+      child { node {}</span>
<span class=hljs-addition>+        child { node {} }</span>
<span class=hljs-addition>+        child { node {} }</span>
<span class=hljs-addition>+      }</span>
<span class=hljs-addition>+      child { node{}</span>
<span class=hljs-addition>+        child{ node{} }</span>
<span class=hljs-addition>+        child{ node {}</span>
<span class=hljs-addition>+          child{ node{} }</span>
<span class=hljs-addition>+          child{ node{} }</span>
<span class=hljs-addition>+        }</span>
<span class=hljs-addition>+      };</span>
<span class=hljs-addition>+   \end{tikzpicture}</span>
<span class=hljs-addition>+&lt;/script&gt;</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+| Leaves | total nodes |</span>
<span class=hljs-addition>+| ------ | ----------- |</span>
<span class=hljs-addition>+| 1      | 1           |</span>
<span class=hljs-addition>+| 2      | 3           |</span>
<span class=hljs-addition>+| 3      | 5           |</span>
<span class=hljs-addition>+| 4      | 7           |</span>
<span class=hljs-addition>+| 5      | 9           |</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+And we should be able to see that we the pattern is $n = 2l - 1$. And remember,</span>
<span class=hljs-addition>+the number of leaves is equal to the number of symbols.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+&lt;p&gt;</span>
<span class=hljs-addition>+Let $s$ be the number of distinct symbols in the data &lt;br /&gt;</span>
<span class=hljs-addition>+&lt;!--markdownlint-disable no-space-in-emphasis--&gt;</span>
<span class=hljs-addition>+$$</span>
<span class=hljs-addition>+\begin{align}</span>
<span class=hljs-addition>+8 * s + 2 * s - 1 = 10 * s - 1</span>
<span class=hljs-addition>+\end{align}</span>
<span class=hljs-addition>+$$</span>
<span class=hljs-addition>+&lt;!--markdownlint-enable no-space-in-emphasis--&gt;</span>
<span class=hljs-addition>+&lt;/p&gt;</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+So it takes $10 * s - 1$ bits to encode the binary tree (double check that...).</span>
<span class=hljs-addition>+Now we need to think about how the data is actually encoded.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+There is one obvious point where the encoding is no longer worth it, and that is</span>
<span class=hljs-addition>+when the encoding for a node ends up being *at least* 8 bits long - or in other words</span>
<span class=hljs-addition>+the depth the leaf nodes of the tree are all at least 8.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+This definitely requires a lot more thought and analysis than my ramble is calling</span>
<span class=hljs-addition>+for, but the idea is that there should be some ratio between the occurrence of shorter</span>
<span class=hljs-addition>+encoded symbols and longer encoded symbols that, once surpassed, can show Huffman</span>
<span class=hljs-addition>+coding to be inefficient. The idea is that a tree like the following:</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+&lt;script type=&quot;text/tikz&quot;&gt;</span>
<span class=hljs-addition>+  \begin{tikzpicture}[nodes={draw, circle, minimum size=0.75cm}, -&gt;]</span>
<span class=hljs-addition>+    \node{}</span>
<span class=hljs-addition>+      child { node {A} }</span>
<span class=hljs-addition>+      child { node{}</span>
<span class=hljs-addition>+        child{ node{} }</span>
<span class=hljs-addition>+        child{ node {}</span>
<span class=hljs-addition>+          child{ node{} }</span>
<span class=hljs-addition>+          child{ node{}</span>
<span class=hljs-addition>+            child { node {} }</span>
<span class=hljs-addition>+            child { node {} }</span>
<span class=hljs-addition>+          }</span>
<span class=hljs-addition>+        }</span>
<span class=hljs-addition>+      };</span>
<span class=hljs-addition>+   \end{tikzpicture}</span>
<span class=hljs-addition>+&lt;/script&gt;</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+But extended far and deep to the right. We can see that $A$ only takes one bit to</span>
<span class=hljs-addition>+encode but the symbols much lower down will - possibly - a lot more than 8 bits to</span>
<span class=hljs-addition>+encode, so for Huffman coding to be efficient, there needs to be a certain amount</span>
<span class=hljs-addition>+of more $A$s compared to the ones down there - intuition says the ratio is also related</span>
<span class=hljs-addition>+to the difference in bit encoding lengths.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+I think the ramble has gone on for some time, so I&#x27;d like to just end with one example</span>
<span class=hljs-addition>+where chunking beats the unencoded while chunking doesn&#x27;t - when the data is $ABCABCDEFDEFGHIGHI$.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Just by looking at it, you can already guess that a good chunk size is going to</span>
<span class=hljs-addition>+be 6, and it turns out that is what is best. If we go with encoding the entire thing,</span>
<span class=hljs-addition>+we get</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+```python</span>
<span class=hljs-addition>+Unencoded Length: 144</span>
<span class=hljs-addition>+Unencoded: 010000010100001001000011010000010100001001000011010001000100010101000110010001000100010101000110010001110100100001001001010001110100100001001001</span>
<span class=hljs-addition>+Encoded Length: 147</span>
<span class=hljs-addition>+Encoded: 111001000011001000100100100010100100011011001000111001001000100100100110010000010010000101110111100011101111000001010011001010011100101110100101110</span>
<span class=hljs-addition>+Data: ABCABCDEFDEFGHIGHI</span>
<span class=hljs-addition>+Decoded: ABCABCDEFDEFGHIGHI</span>
<span class=hljs-addition>+```</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+3 more bits! But chunking it down to chunks of 6, we get</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+```python</span>
<span class=hljs-addition>+Unencoded Length: 48</span>
<span class=hljs-addition>+Unencoded: 010000010100001001000011010000010100001001000011</span>
<span class=hljs-addition>+Encoded Length: 39</span>
<span class=hljs-addition>+Encoded: 100100001110010000010010000101011010110</span>
<span class=hljs-addition>+Data: ABCABCDEFDEFGHIGHI</span>
<span class=hljs-addition>+Decoded: ABCABC</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 48</span>
<span class=hljs-addition>+Unencoded: 010001000100010101000110010001000100010101000110</span>
<span class=hljs-addition>+Encoded Length: 39</span>
<span class=hljs-addition>+Encoded: 100100011010010001000010001011011010110</span>
<span class=hljs-addition>+Data: ABCABCDEFDEFGHIGHI</span>
<span class=hljs-addition>+Decoded: DEFDEF</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Unencoded Length: 48</span>
<span class=hljs-addition>+Unencoded: 010001110100100001001001010001110100100001001001</span>
<span class=hljs-addition>+Encoded Length: 39</span>
<span class=hljs-addition>+Encoded: 100100100110010001110010010001011010110</span>
<span class=hljs-addition>+Data: ABCABCDEFDEFGHIGHI</span>
<span class=hljs-addition>+Decoded: GHIGHI</span>
<span class=hljs-addition>+```</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+117 bits! An improvement of 27 bits!</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+## further reading</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Looking at the [wikipedia page for Huffman coding](https://en.wikipedia.org/wiki/Huffman_coding),</span>
<span class=hljs-addition>+there are two other algorithms mentioned: [arithmetic coding](https://en.wikipedia.org/wiki/Arithmetic_coding)</span>
<span class=hljs-addition>+and [asymmetric numeral systems](https://en.wikipedia.org/wiki/Asymmetric_numeral_systems).</span>
<span class=hljs-addition>+Pretty interesting stuff.</span>
<span class=hljs-addition>+</span>
<span class=hljs-addition>+Ramble over.</span>
</code></pre>
</details>
</div>
</div>
</div>
<picture id=very-cute-picture><img onerror='load_backup_image("/scripts/cozy_reimu.bmp"),load_backup_image("/scripts/unamused_reimu.bmp")' srcset=reimu>
</picture>
</body>
</html>
